<%- include('partials/header') %>

<div class="w-full min-h-screen bg-zinc-900 text-white px-4 pb-16 pt-6">
  <h2 class="text-2xl font-bold mb-6 px-1">Messages</h2>

  <% recentChats.forEach(chat => { %>
    <a href="/chat/<%= chat.user._id %>" class="flex items-center gap-4 p-3 rounded-lg hover:bg-zinc-800 transition">
      <img src="<%= chat.user.profilePic ? '/images/uploads/' + chat.user.profilePic : '/images/image.png' %>" 
     onerror="this.onerror=null;this.src='/images/image.png';"
     class="w-12 h-12 rounded-full object-cover border border-zinc-700" />
      <div class="flex-1">
        <p class="font-semibold text-base"><%= chat.user.name || chat.user.username %></p>
        <% if (chat.lastMsg) { %>
          <p class="text-sm text-gray-400 truncate max-w-[200px]">
            <%= chat.lastMsg.text %>
          </p>
        <% } else { %>
          <p class="text-sm text-gray-500 italic">Start a conversation</p>
        <% } %>
      </div>
    </a>
  <% }) %>

  <% if (recentChats.length === 0) { %>
    <p class="text-gray-400 text-center mt-10">No conversations yet. Start chatting!</p>
  <% } %>
</div>

<%- include('partials/footer') %>
